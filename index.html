<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Real Proof Maker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/piexifjs/1.0.6/piexif.js"></script>
    <style>
        :root {
            --bg-color: #e0e5ec;
            --text-color: #4a4a4a;
            --shadow-light: #ffffff;
            --shadow-dark: #a3b1c6;
            --accent: #007bff;
            --success: #00b894;
            --danger: #ff4757;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', sans-serif;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; margin: 0;
        }

        .mobile-container {
            width: 90%; max-width: 400px;
            background-color: var(--bg-color);
            border-radius: 20px; padding: 20px;
            box-shadow: 10px 10px 20px var(--shadow-dark), -10px -10px 20px var(--shadow-light);
            min-height: 600px; position: relative; overflow: hidden;
            text-align: center;
        }

        h2 { text-align: center; color: var(--text-color); margin-bottom: 20px; }

        /* Neumorphic Button Style */
        .neu-btn {
            width: 100%; padding: 15px; border: none; border-radius: 12px;
            background: var(--bg-color);
            box-shadow: 6px 6px 12px var(--shadow-dark), -6px -6px 12px var(--shadow-light);
            color: var(--text-color); font-weight: bold; font-size: 16px;
            cursor: pointer; outline: none; transition: 0.2s; margin-bottom: 15px;
            display: flex; align-items: center; justify-content: center;
        }
        .neu-btn:active { box-shadow: inset 4px 4px 8px var(--shadow-dark), inset -4px -4px 8px var(--shadow-light); }
        .neu-btn:disabled { color: #aaa; box-shadow: none; cursor: not-allowed; }

        .btn-select { color: var(--accent); }
        .btn-save { color: var(--success); }

        .upload-area {
            text-align: center; padding: 20px; border-radius: 15px;
            box-shadow: inset 6px 6px 12px var(--shadow-dark), inset -6px -6px 12px var(--shadow-light);
            margin-bottom: 25px;
        }
        
        input[type="file"] { display: none; }

        #preview {
            width: 150px; height: 150px; object-fit: contain; border-radius: 10px;
            margin-top: 15px; display: none;
            box-shadow: 4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light);
            border: 3px solid var(--bg-color);
            margin-left: auto; margin-right: auto;
        }

        /* Location Status Box */
        .status-box {
            padding: 15px; border-radius: 12px; margin-bottom: 20px; font-size: 14px; font-weight: bold;
            display: none;
        }
        .status-error { color: var(--danger); box-shadow: inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light); }
        .status-ok { color: var(--success); box-shadow: 6px 6px 12px var(--shadow-dark), -6px -6px 12px var(--shadow-light); }

        /* Modal for Location Error */
        .modal-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(224, 229, 236, 0.9); z-index: 100;
            display: none; justify-content: center; align-items: center;
        }
        .modal-box {
            background: var(--bg-color); padding: 30px; border-radius: 20px;
            box-shadow: 10px 10px 20px var(--shadow-dark), -10px -10px 20px var(--shadow-light);
            text-align: center; width: 80%;
        }
    </style>
</head>
<body>

    <div class="mobile-container">
        <h2>üìç Proof Maker</h2>

        <div class="modal-overlay" id="locationModal">
            <div class="modal-box">
                <h3 style="color:var(--danger)">‚ö†Ô∏è ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ö‡¶´!</h3>
                <p>‡¶Ü‡¶Æ‡ßç‡¶Æ‡ßÅ‡¶ï‡ßá ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶π‡¶≤‡ßá ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á GPS ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§</p>
                <button class="neu-btn" onclick="checkLocation()">üîÑ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>

        <div class="upload-area">
            <input type="file" id="fileInput" accept="image/jpeg, image/jpg, image/png">
            <button class="neu-btn btn-select" onclick="document.getElementById('fileInput').click()">
                üìÇ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
            </button>
            <img id="preview" src="">
        </div>

        <div id="statusBox" class="status-box"></div>

        <div id="actionButtons" style="display:none;">
            <button id="saveBtn" class="neu-btn btn-save" onclick="injectAndSave()" disabled>
                üíæ ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶® (Save)
            </button>
            <p style="font-size:12px; color:#666;">*‡¶è‡¶á ‡¶õ‡¶¨‡¶ø‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶Æ‡ßü ‡¶¢‡ßÅ‡¶ï‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§</p>
        </div>

    </div>

    <script>
        let currentImgData = null;
        let userLat = null;
        let userLng = null;

        // ‡ßß. ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá‡¶á ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ö‡¶æ‡¶™‡¶≤‡ßá ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶¨‡ßá
        document.getElementById('fileInput').addEventListener('change', function(e) {
            let file = e.target.files[0];
            if (file) {
                let reader = new FileReader();
                reader.onload = function(event) {
                    currentImgData = event.target.result;
                    let img = document.getElementById('preview');
                    img.src = currentImgData;
                    img.style.display = 'block';
                    
                    document.querySelector('.btn-select').innerText = "üîÑ ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶®";
                    document.getElementById('actionButtons').style.display = 'block';
                    
                    // ‡¶õ‡¶¨‡¶ø ‡¶®‡ßá‡¶ì‡ßü‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶•‡ßá‡¶á ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ö‡ßá‡¶ï ‡¶∂‡ßÅ‡¶∞‡ßÅ
                    checkLocation();
                }
                reader.readAsDataURL(file);
            }
        });

        // ‡ß®. ‡¶ï‡¶°‡¶º‡¶æ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ö‡ßá‡¶ï‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        function checkLocation() {
            let statusBox = document.getElementById('statusBox');
            let modal = document.getElementById('locationModal');
            let saveBtn = document.getElementById('saveBtn');

            statusBox.style.display = 'block';
            statusBox.className = 'status-box status-error';
            statusBox.innerText = "‚è≥ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";

            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(
                    // ‡¶∏‡¶æ‡¶ï‡¶∏‡ßá‡¶∏ ‡¶π‡¶≤‡ßá
                    function(position) {
                        userLat = position.coords.latitude;
                        userLng = position.coords.longitude;

                        // ‡¶™‡¶™‡¶Ü‡¶™ ‡¶¨‡¶®‡ßç‡¶ß, ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ö‡¶æ‡¶≤‡ßÅ
                        modal.style.display = 'none';
                        saveBtn.disabled = false;
                        
                        statusBox.className = 'status-box status-ok';
                        statusBox.innerHTML = `‚úÖ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶≤‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!<br><span style="font-size:10px">Lat: ${userLat.toFixed(4)}, Lng: ${userLng.toFixed(4)}</span>`;
                    },
                    // ‡¶è‡¶∞‡¶∞ ‡¶π‡¶≤‡ßá (‡¶Ø‡¶¶‡¶ø ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ö‡¶´ ‡¶•‡¶æ‡¶ï‡ßá ‡¶¨‡¶æ ‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶®‡¶æ ‡¶¶‡ßá‡ßü)
                    function(error) {
                        modal.style.display = 'flex'; // ‡¶™‡¶™‡¶Ü‡¶™ ‡¶∂‡ßã ‡¶ï‡¶∞‡¶¨‡ßá
                        saveBtn.disabled = true; // ‡¶¨‡¶æ‡¶ü‡¶® ‡¶°‡¶ø‡¶ú‡ßá‡¶¨‡¶≤
                        statusBox.className = 'status-box status-error';
                        statusBox.innerText = "‚ùå ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø!";
                    },
                    { enableHighAccuracy: true } // ‡¶π‡¶æ‡¶á ‡¶è‡¶ï‡ßÅ‡¶∞‡ßá‡¶∏‡¶ø ‡¶Æ‡ßÅ‡¶°
                );
            } else {
                alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶õ‡ßá ‡¶®‡¶æ‡•§");
            }
        }

        // ‡ß©. ‡¶Æ‡ßá‡¶ü‡¶æ‡¶°‡¶æ‡¶ü‡¶æ ‡¶¢‡ßÅ‡¶ï‡¶æ‡¶®‡ßã ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ (‡¶Æ‡ßá‡¶á‡¶® ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ú‡¶ø‡¶ï)
        function injectAndSave() {
            if (!currentImgData || !userLat) {
                alert("‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶õ‡¶æ‡ßú‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ!");
                checkLocation();
                return;
            }

            // Piexif ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∞‡ßá‡¶°‡¶ø ‡¶ï‡¶∞‡¶æ
            let zeroth = {};
            let exif = {};
            let gps = {};

            // ‡¶ï. ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ (‡¶§‡ßã‡¶∞ ‡¶´‡ßã‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ)
            zeroth[piexif.ImageIFD.Make] = "Infinix";
            zeroth[piexif.ImageIFD.Model] = "Infinix X6827";
            zeroth[piexif.ImageIFD.Software] = "MediaTek Camera Application";

            // ‡¶ñ. ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∏‡¶Æ‡ßü
            let now = new Date();
            let timeStr = now.getFullYear() + ":" + (now.getMonth()+1).toString().padStart(2,'0') + ":" + now.getDate().toString().padStart(2,'0') + " " + 
                          now.getHours().toString().padStart(2,'0') + ":" + now.getMinutes().toString().padStart(2,'0') + ":" + now.getSeconds().toString().padStart(2,'0');
            
            zeroth[piexif.ImageIFD.DateTime] = timeStr;
            exif[piexif.ExifIFD.DateTimeOriginal] = timeStr;
            exif[piexif.ExifIFD.DateTimeDigitized] = timeStr;

            // ‡¶ó. ‡¶ú‡¶ø‡¶™‡¶ø‡¶è‡¶∏ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ï‡¶®‡¶≠‡¶æ‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ (Piexif ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá)
            gps[piexif.GPSIFD.GPSLatitudeRef] = userLat < 0 ? 'S' : 'N';
            gps[piexif.GPSIFD.GPSLatitude] = piexif.GPSHelper.degToDmsRational(Math.abs(userLat));
            gps[piexif.GPSIFD.GPSLongitudeRef] = userLng < 0 ? 'W' : 'E';
            gps[piexif.GPSIFD.GPSLongitude] = piexif.GPSHelper.degToDmsRational(Math.abs(userLng));

            // ‡¶ò. ‡¶¨‡¶æ‡¶á‡¶®‡¶æ‡¶∞‡¶ø ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ
            let exifObj = {"0th": zeroth, "Exif": exif, "GPS": gps};
            let exifStr = piexif.dump(exifObj);

            // ‡¶ô. ‡¶á‡¶Æ‡ßá‡¶ú‡ßá ‡¶á‡¶®‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ
            let newImage = piexif.insert(exifStr, currentImgData);

            // ‡¶ö. ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ (‡¶®‡¶æ‡¶Æ‡¶ü‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßá‡¶∞‡¶æ‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá)
            let link = document.createElement('a');
            link.href = newImage;
            // ‡¶è‡¶á ‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø‡¶§‡ßá ‡¶∏‡ßá‡¶≠ ‡¶π‡¶§‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡ßá
            link.download = "IMG_" + now.getFullYear() + (now.getMonth()+1).toString().padStart(2,'0') + now.getDate().toString().padStart(2,'0') + "_" + now.getHours() + now.getMinutes() + now.getSeconds() + ".jpg";
            link.click();
            
            alert("üéâ ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø‡¶∞ 'Downloads' ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞‡ßá ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
        }
    </script>
</body>
</html>